// –î–∞–Ω–Ω—ã–µ –∫–≤–∞—Ä—Ç–∏—Ä
const apartments = {
    1: {
        title: "–ö–≤–∞—Ä—Ç–∏—Ä–∞ 1",
        description: "–ü—Ä–æ—Å—Ç–æ—Ä–Ω–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ —Å –ø–∞–Ω–æ—Ä–∞–º–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏ –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ä–µ–º–æ–Ω—Ç–æ–º. –ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø–∞—Ä –∏–ª–∏ –Ω–µ–±–æ–ª—å—à–æ–π —Å–µ–º—å–∏. –ï—Å—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–Ω–∞—è –∫—É—Ö–Ω—è –∏ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è —Å–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∞.",
        price: "4 000 ‚ÇΩ/–Ω–æ—á—å",
        images: [
            "images/apartment-1-1.jpg",
            "images/apartment-1-2.jpg",
            "images/apartment-1-3.jpg",
            "images/apartment-1-4.jpg",
            "images/apartment-1-5.jpg",
            "images/apartment-1-6.jpg",
            "images/apartment-1-7.jpg",
            "images/apartment-1-8.jpg",
            "images/apartment-1-9.jpg",
            "images/apartment-1-10.jpg"
        ]
    },
    2: {
        title: "–ö–≤–∞—Ä—Ç–∏—Ä–∞ 2", 
        description: "–î–≤—É—Ö–∫–æ–º–Ω–∞—Ç–Ω–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ —Å –≤–∏–¥–æ–º –Ω–∞ –≥–æ—Ä–æ–¥. –ü—Ä–æ—Å—Ç–æ—Ä–Ω–∞—è –≥–æ—Å—Ç–∏–Ω–∞—è –∏ —É—é—Ç–Ω–∞—è —Å–ø–∞–ª—å–Ω—è. –°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∫—É—Ö–Ω—è-–≥–æ—Å—Ç–∏–Ω–∞—è –∏ –±–æ–ª—å—à–∞—è –≤–∞–Ω–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞.",
        price: "4 000 ‚ÇΩ/–Ω–æ—á—å",
        images: [
            "images/apartment-2-1.jpg",
            "images/apartment-2-2.jpg",
            "images/apartment-2-3.jpg",
            "images/apartment-2-4.jpg",
            "images/apartment-2-5.jpg",
            "images/apartment-2-6.jpg",
            "images/apartment-2-7.jpg",
            "images/apartment-2-8.jpg",
            "images/apartment-2-9.jpg",
            "images/apartment-2-10.jpg",
            "images/apartment-2-11.jpg",
            "images/apartment-2-12.jpg"
        ]
    },
    3: {
        title: "–ö–≤–∞—Ä—Ç–∏—Ä–∞ 3",
        description: "–°–≤–µ—Ç–ª–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞-—Å—Ç—É–¥–∏—è —Å –ø–∞–Ω–æ—Ä–∞–º–Ω—ã–º–∏ –æ–∫–Ω–∞–º–∏. –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –¥–∏–∑–∞–π–Ω, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∫–∞. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –º–æ–ª–æ–¥—ã—Ö –ø–∞—Ä –∏–ª–∏ –±–∏–∑–Ω–µ—Å-–ø–æ–µ–∑–¥–æ–∫.",
        price: "4 000 ‚ÇΩ/–Ω–æ—á—å",
        images: [
            "images/apartment-3-1.jpg",
            "images/apartment-3-2.jpg",
            "images/apartment-3-3.jpg",
            "images/apartment-3-4.jpg",
            "images/apartment-3-5.jpg",
            "images/apartment-3-6.jpg",
            "images/apartment-3-7.jpg",
            "images/apartment-3-8.jpg",
            "images/apartment-3-9.jpg",
            "images/apartment-3-10.jpg",
            "images/apartment-3-11.jpg",
            "images/apartment-3-12.jpg",
            "images/apartment-3-13.jpg"
        ]
    },
    4: {
        title: "–ö–≤–∞—Ä—Ç–∏—Ä–∞ 4",
        description: "–ü—Ä–æ—Å—Ç–æ—Ä–Ω–∞—è —Ç—Ä—ë—Ö–∫–æ–º–Ω–∞—Ç–Ω–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ –¥–ª—è —Å–µ–º—å–∏. –î–≤–µ —Å–ø–∞–ª—å–Ω–∏, –≥–æ—Å—Ç–∏–Ω–∞—è –∏ –±–æ–ª—å—à–∞—è –∫—É—Ö–Ω—è. –ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è —Å–µ–º–µ–π–Ω–æ–≥–æ –æ—Ç–¥—ã—Ö–∞ –∏–ª–∏ –¥–ª–∏—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è.",
        price: "4 000 ‚ÇΩ/–Ω–æ—á—å",
        images: [
            "images/apartment-4-1.jpg",
            "images/apartment-4-2.jpg",
            "images/apartment-4-3.jpg",
            "images/apartment-4-4.jpg",
            "images/apartment-4-5.jpg",
            "images/apartment-4-6.jpg",
            "images/apartment-4-7.jpg",
            "images/apartment-4-8.jpg",
            "images/apartment-4-9.jpg",
            "images/apartment-4-10.jpg",
            "images/apartment-4-11.jpg",
            "images/apartment-4-12.jpg",
            "images/apartment-4-13.jpg",
            "images/apartment-4-14.jpg"
        ]
    },
    5: {
        title: "–ö–≤–∞—Ä—Ç–∏—Ä–∞ 5",
        description: "–£—é—Ç–Ω–∞—è –∫–≤–∞—Ä—Ç–∏—Ä–∞ —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –µ–≤—Ä–æ—Ä–µ–º–æ–Ω—Ç–æ–º. –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—Ç–¥–µ–ª–æ—á–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã, –Ω–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞. –û—Ç–ª–∏—á–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –¥–ª—è –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–≥–æ –ø—Ä–æ–∂–∏–≤–∞–Ω–∏—è.",
        price: "4 000 ‚ÇΩ/–Ω–æ—á—å",
        images: [
            "images/apartment-5-1.jpg",
            "images/apartment-5-2.jpg",
            "images/apartment-5-3.jpg",
            "images/apartment-5-4.jpg",
            "images/apartment-5-5.jpg",
            "images/apartment-5-6.jpg",
            "images/apartment-5-7.jpg",
            "images/apartment-5-8.jpg",
            "images/apartment-5-9.jpg",
            "images/apartment-5-10.jpg",
            "images/apartment-5-11.jpg",
            "images/apartment-5-12.jpg"
        ]
    }
};

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
function setupImageErrorHandling() {
    // –î–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –∫–≤–∞—Ä—Ç–∏—Ä
    document.querySelectorAll('.card-image img, .about-img').forEach(img => {
        img.addEventListener('error', function() {
            this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjhmYWZjIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxOCIgZmlsbD0iIzk0YTBhZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlIG5vdCBmb3VuZDwvdGV4dD48L3N2Zz4=';
            this.alt = '–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ';
            this.classList.add('image-fallback');
        });
    });
}

// –§—É–Ω–∫—Ü–∏—è –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –≥–∞–ª–µ—Ä–µ–∏
function preloadImages(imageUrls) {
    imageUrls.forEach(src => {
        const img = new Image();
        img.src = src;
    });
}

// –§—É–Ω–∫—Ü–∏—è –ª–µ–Ω–∏–≤–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ –∫–≤–∞—Ä—Ç–∏—Ä
function setupLazyLoading() {
    const lazyImages = document.querySelectorAll('.card-image img[loading="lazy"]');
    
    if ('IntersectionObserver' in window) {
        const imageObserver = new IntersectionObserver((entries, observer) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    // –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–æ
                    if (img.dataset.src) {
                        img.src = img.dataset.src;
                        img.classList.remove('lazy');
                    }
                    imageObserver.unobserve(img);
                }
            });
        });

        lazyImages.forEach(img => {
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π src –≤ data-src
            img.dataset.src = img.src;
            // –ó–∞–º–µ–Ω—è–µ–º –Ω–∞ –º–∞–ª–µ–Ω—å–∫–æ–µ placeholder –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            img.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjhmYWZjIi8+PC9zdmc+';
            img.classList.add('lazy');
            imageObserver.observe(img);
        });
    }
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –º–∞—Å–∫–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
function setupPhoneMask() {
    const phoneInput = document.getElementById('bookingPhone');
    if (!phoneInput) return;

    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
    phoneInput.value = '+7 (';
    
    phoneInput.addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        
        // –£–±–∏—Ä–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—É—é 7 –∏–ª–∏ 8
        if (value.startsWith('7') || value.startsWith('8')) {
            value = value.substring(1);
        }
        
        // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É (10 —Ü–∏—Ñ—Ä –ø–æ—Å–ª–µ +7)
        if (value.length > 10) {
            value = value.substring(0, 10);
        }
        
        // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –Ω–æ–º–µ—Ä
        let formattedValue = '+7 (';
        
        if (value.length > 0) {
            formattedValue += value.substring(0, 3);
        }
        if (value.length > 3) {
            formattedValue += ') ' + value.substring(3, 6);
        }
        if (value.length > 6) {
            formattedValue += '-' + value.substring(6, 8);
        }
        if (value.length > 8) {
            formattedValue += '-' + value.substring(8, 10);
        }
        
        e.target.value = formattedValue;
    });

    // –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ —É—Ö–æ–¥–µ —Å –ø–æ–ª—è
    phoneInput.addEventListener('blur', function() {
        const digits = this.value.replace(/\D/g, '');
        if (digits.length !== 11) {
            this.style.borderColor = '#ef4444';
            this.style.backgroundColor = '#fef2f2';
        } else {
            this.style.borderColor = '';
            this.style.backgroundColor = '';
        }
    });

    // –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∏–ª–µ–π –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
    phoneInput.addEventListener('focus', function() {
        this.style.borderColor = '';
        this.style.backgroundColor = '';
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ Backspace –∏ Delete
    phoneInput.addEventListener('keydown', function(e) {
        if (e.key === 'Backspace' || e.key === 'Delete') {
            // –ï—Å–ª–∏ –ø—ã—Ç–∞—é—Ç—Å—è —É–¥–∞–ª–∏—Ç—å –Ω–∞—á–∞–ª–æ –º–∞—Å–∫–∏, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º
            if (this.value.length <= 4) {
                e.preventDefault();
                this.value = '+7 (';
            }
        }
    });
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
function validatePhone(phone) {
    const digits = phone.replace(/\D/g, '');
    return digits.length === 11; // +7 + 10 —Ü–∏—Ñ—Ä
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ UX
function enhanceMobileUX() {
    // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ –Ω–∞ –ø–æ–ª—è—Ö –≤–≤–æ–¥–∞ –≤ iOS
    document.addEventListener('touchstart', function() {}, { passive: true });
    
    // –£–ª—É—á—à–∞–µ–º —Ä–∞–±–æ—Ç—É –≥–∞–ª–µ—Ä–µ–∏ –Ω–∞ —Ç–∞—á-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
    let touchStartX = 0;
    let touchEndX = 0;
    
    document.addEventListener('touchstart', function(e) {
        if (e.target.closest('.modal-gallery')) {
            touchStartX = e.changedTouches[0].screenX;
        }
    }, { passive: true });
    
    document.addEventListener('touchend', function(e) {
        if (e.target.closest('.modal-gallery')) {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }
    }, { passive: true });
    
    function handleSwipe() {
        const swipeThreshold = 50;
        const diff = touchStartX - touchEndX;
        
        if (Math.abs(diff) > swipeThreshold) {
            if (diff > 0) {
                // –°–≤–∞–π–ø –≤–ª–µ–≤–æ - —Å–ª–µ–¥—É—é—â–µ–µ —Ñ–æ—Ç–æ
                nextImage();
            } else {
                // –°–≤–∞–π–ø –≤–ø—Ä–∞–≤–æ - –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Ñ–æ—Ç–æ
                prevImage();
            }
        }
    }
    
    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—É–∂–µ –µ—Å—Ç—å, –Ω–æ —É–ª—É—á—à–∏–º –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö)
    document.addEventListener('touchstart', function(e) {
        if (e.target.classList.contains('modal-overlay')) {
            closeApartmentModal();
            closeBookingModal();
        }
    }, { passive: true });
}

function setupHeaderScroll() {
    const header = document.querySelector('.header');
    const hero = document.querySelector('.hero');
    
    if (!header || !hero) return;
    
    function updateHeader() {
        const scrollY = window.scrollY;
        const heroHeight = hero.offsetHeight;
        
        if (scrollY > heroHeight - 100) {
            header.classList.add('scrolled');
        } else {
            header.classList.remove('scrolled');
        }
    }
    
    window.addEventListener('scroll', updateHeader);
    updateHeader();
}

let currentApartment = null;
let currentImageIndex = 0;

// –§—É–Ω–∫—Ü–∏–∏ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≥–∞–ª–µ—Ä–µ–∏
function openApartmentModal(apartmentId) {
    currentApartment = apartments[apartmentId];
    currentImageIndex = 0;
    
    const modal = document.getElementById('apartmentModal');
    
    if (!currentApartment) {
        console.error('–ö–≤–∞—Ä—Ç–∏—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞:', apartmentId);
        return;
    }
    
    // –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≥–∞–ª–µ—Ä–µ–∏
    preloadImages(currentApartment.images);
    
    // –°–æ–∑–¥–∞–µ–º –≥–∞–ª–µ—Ä–µ—é –∏ –º–∏–Ω–∏–∞—Ç—é—Ä—ã
    updateGallery();
    
    modal.style.display = 'block';
    document.body.style.overflow = 'hidden';
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –¥–ª—è –º–æ–¥–∞–ª–∫–∏
    setTimeout(() => {
        document.querySelectorAll('.modal-gallery img, .modal-thumbnails img').forEach(img => {
            img.addEventListener('error', function() {
                this.src = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjhmYWZjIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCIgZm9udC1zaXplPSIxOCIgZmlsbD0iIzk0YTBhZSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkltYWdlIG5vdCBmb3VuZDwvdGV4dD48L3N2Zz4=';
                this.alt = '–§–æ—Ç–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ';
                this.classList.add('image-fallback');
            });
        });
    }, 100);
}

function updateGallery() {
    const gallery = document.querySelector('.modal-gallery');
    const thumbnails = document.getElementById('modalThumbnails');
    
    if (!currentApartment || !currentApartment.images.length) return;
    
    // –ì–ª–∞–≤–Ω–æ–µ —Ñ–æ—Ç–æ
    gallery.innerHTML = `
        <div class="main-image-container">
            <img src="${currentApartment.images[currentImageIndex]}" alt="${currentApartment.title} - –§–æ—Ç–æ ${currentImageIndex + 1}" class="main-image">
            <button class="gallery-nav gallery-prev" onclick="prevImage()" aria-label="–ü—Ä–µ–¥—ã–¥—É—â–µ–µ —Ñ–æ—Ç–æ">‚Äπ</button>
            <button class="gallery-nav gallery-next" onclick="nextImage()" aria-label="–°–ª–µ–¥—É—é—â–µ–µ —Ñ–æ—Ç–æ">‚Ä∫</button>
            <div class="image-counter">${currentImageIndex + 1} / ${currentApartment.images.length}</div>
        </div>
    `;
    
    // –ú–∏–Ω–∏–∞—Ç—é—Ä—ã –≤–Ω–∏–∑—É
    thumbnails.innerHTML = '';
    currentApartment.images.forEach((imageSrc, index) => {
        const thumb = document.createElement('img');
        thumb.src = imageSrc;
        thumb.alt = `–ú–∏–Ω–∏–∞—Ç—é—Ä–∞ ${index + 1}`;
        thumb.className = `thumbnail ${index === currentImageIndex ? 'active' : ''}`;
        thumb.onclick = () => changeImage(index);
        thumbnails.appendChild(thumb);
    });
}

function changeImage(index) {
    currentImageIndex = index;
    updateGallery();
}

function nextImage() {
    if (!currentApartment) return;
    currentImageIndex = (currentImageIndex + 1) % currentApartment.images.length;
    updateGallery();
}

function prevImage() {
    if (!currentApartment) return;
    currentImageIndex = (currentImageIndex - 1 + currentApartment.images.length) % currentApartment.images.length;
    updateGallery();
}

function closeApartmentModal() {
    const modal = document.getElementById('apartmentModal');
    modal.style.display = 'none';
    document.body.style.overflow = 'auto';
    currentApartment = null;
    currentImageIndex = 0;
}

// –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
function openBookingModal(apartmentId = '') {
    const modal = document.getElementById('bookingModal');
    
    // –ï—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–Ω ID –∫–≤–∞—Ä—Ç–∏—Ä—ã, –≤—ã–±–∏—Ä–∞–µ–º –µ—ë –≤ —Ñ–æ—Ä–º–µ
    if (apartmentId && document.getElementById('bookingApartment')) {
        document.getElementById('bookingApartment').value = apartmentId;
    }
    
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–∞—Ç—É - —Å–µ–≥–æ–¥–Ω—è
    const today = new Date().toISOString().split('T')[0];
    const checkinInput = document.getElementById('bookingCheckin');
    const checkoutInput = document.getElementById('bookingCheckout');
    
    if (checkinInput) {
        checkinInput.min = today;
        checkinInput.value = ''; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
    }
    if (checkoutInput) {
        checkoutInput.min = today;
        checkoutInput.value = ''; // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
    }
    
    modal.style.display = 'block';
    document.body.style.overflow = 'hidden';
}

function closeBookingModal() {
    const modal = document.getElementById('bookingModal');
    modal.style.display = 'none';
    document.body.style.overflow = 'auto';
}

// –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã
function validateBookingForm() {
    const checkin = document.getElementById('bookingCheckin');
    const checkout = document.getElementById('bookingCheckout');
    const name = document.getElementById('bookingName');
    const phone = document.getElementById('bookingPhone');
    const apartment = document.getElementById('bookingApartment');
    
    if (!checkin || !checkout || !name || !phone || !apartment) {
        alert('–û—à–∏–±–∫–∞: –Ω–µ –≤—Å–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã –Ω–∞–π–¥–µ–Ω—ã');
        return false;
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
    if (!checkin.value || !checkout.value || !name.value || !phone.value || !apartment.value) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
        return false;
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –¥–∞—Ç–∞ –≤—ã–µ–∑–¥–∞ –ø–æ—Å–ª–µ –¥–∞—Ç—ã –∑–∞–µ–∑–¥–∞
    if (checkout.value <= checkin.value) {
        alert('–î–∞—Ç–∞ –≤—ã–µ–∑–¥–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ—Å–ª–µ –¥–∞—Ç—ã –∑–∞–µ–∑–¥–∞');
        return false;
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (1 –Ω–æ—á—å)
    const checkinDate = new Date(checkin.value);
    const checkoutDate = new Date(checkout.value);
    const nights = Math.ceil((checkoutDate - checkinDate) / (1000 * 60 * 60 * 24));
    
    if (nights < 1) {
        alert('–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ - 1 –Ω–æ—á—å');
        return false;
    }
    
    // –û–ë–ù–û–í–õ–ï–ù–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê –¢–ï–õ–ï–§–û–ù–ê
    if (!validatePhone(phone.value)) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (10 —Ü–∏—Ñ—Ä –ø–æ—Å–ª–µ +7)');
        phone.style.borderColor = '#ef4444';
        phone.style.backgroundColor = '#fef2f2';
        phone.focus();
        return false;
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–µ–Ω–∏ (—Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã –∏ –ø—Ä–æ–±–µ–ª—ã)
    const nameRegex = /^[a-zA-Z–∞-—è–ê-–Ø—ë–Å\s]+$/;
    if (!nameRegex.test(name.value.trim())) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∏–º—è (—Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã)');
        name.style.borderColor = '#ef4444';
        name.style.backgroundColor = '#fef2f2';
        name.focus();
        return false;
    }
    
    return true;
}

// –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ñ–æ—Ä–º—ã
function getFormData() {
    const checkin = document.getElementById('bookingCheckin').value;
    const checkout = document.getElementById('bookingCheckout').value;
    const apartment = document.getElementById('bookingApartment');
    const name = document.getElementById('bookingName').value;
    const phone = document.getElementById('bookingPhone').value;
    const email = document.getElementById('bookingEmail').value;
    const guests = document.getElementById('bookingGuests').value;
    const comment = document.getElementById('bookingComment').value;
    
    // –†–∞—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–æ—á–µ–π
    const checkinDate = new Date(checkin);
    const checkoutDate = new Date(checkout);
    const nights = Math.ceil((checkoutDate - checkinDate) / (1000 * 60 * 60 * 24));
    
    const apartmentText = apartment.options[apartment.selectedIndex].text;
    
    return {
        checkin,
        checkout,
        nights,
        apartment: apartmentText,
        name,
        phone,
        email,
        guests,
        comment
    };
}

// –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram
async function sendToTelegram(formData) {
    const BOT_TOKEN = '8569135069:AAGxg4hOGcSIaemwy1vusiHfNbkTflV5sKk';
    const CHAT_IDS = [
        2121761373,           // –í–∞—à –ª–∏—á–Ω—ã–π ID  
        -1003253038474        // ID –≥—Ä—É–ø–ø—ã
    ];
    
    const message = `
üéØ –ù–û–í–ê–Ø –ó–ê–Ø–í–ö–ê –ù–ê –ë–†–û–ù–ò–†–û–í–ê–ù–ò–ï

üè† –ö–≤–∞—Ä—Ç–∏—Ä–∞: ${formData.apartment}
üìÖ –î–∞—Ç—ã: ${formData.checkin} - ${formData.checkout} (${formData.nights} –Ω–æ—á–µ–π)
üë§ –ì–æ—Å—Ç—å: ${formData.name}
üìû –¢–µ–ª–µ—Ñ–æ–Ω: ${formData.phone}
üìß Email: ${formData.email || '–Ω–µ —É–∫–∞–∑–∞–Ω'}
üë• –ì–æ—Å—Ç–µ–π: ${formData.guests}
üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π: ${formData.comment || '–Ω–µ—Ç'}

‚è∞ –í—Ä–µ–º—è –∑–∞—è–≤–∫–∏: ${new Date().toLocaleString()}
    `;
    
    try {
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤—Å–µ–º –ø–æ–ª—É—á–∞—Ç–µ–ª—è–º –∏–∑ –º–∞—Å—Å–∏–≤–∞ CHAT_IDS
        const sendPromises = CHAT_IDS.map(chatId => 
            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    chat_id: chatId,
                    text: message,
                    parse_mode: 'HTML'
                })
            })
        );
        
        // –ñ–¥–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫
        const results = await Promise.all(sendPromises);
        const jsonResults = await Promise.all(results.map(r => r.json()));
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —á—Ç–æ –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
        const allSent = jsonResults.every(result => result.ok);
        
        return allSent;
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ Telegram:', error);
        return false;
    }
}

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
function showNotification(message, type = 'info') {
    // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    const notification = document.createElement('div');
    notification.className = `notification notification-${type}`;
    notification.innerHTML = `
        <div class="notification-content">
            <span class="notification-message">${message}</span>
            <button class="notification-close" aria-label="–ó–∞–∫—Ä—ã—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ">√ó</button>
        </div>
    `;
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    if (!document.querySelector('#notification-styles')) {
        const styles = document.createElement('style');
        styles.id = 'notification-styles';
        styles.textContent = `
            .notification {
                position: fixed;
                top: 20px;
                right: 20px;
                background: white;
                border-radius: 8px;
                box-shadow: 0 4px 20px rgba(0,0,0,0.15);
                border-left: 4px solid var(--accent);
                z-index: 10000;
                max-width: 400px;
                animation: slideIn 0.3s ease;
            }
            
            .notification-success {
                border-left-color: #10b981;
            }
            
            .notification-error {
                border-left-color: #ef4444;
            }
            
            .notification-content {
                padding: 1rem;
                display: flex;
                align-items: center;
                justify-content: space-between;
                gap: 1rem;
            }
            
            .notification-message {
                flex: 1;
                color: var(--dark);
                font-size: 0.9rem;
            }
            
            .notification-close {
                background: none;
                border: none;
                font-size: 1.2rem;
                cursor: pointer;
                color: var(--secondary);
                padding: 0;
                width: 24px;
                height: 24px;
                display: flex;
                align-items: center;
                justify-content: center;
            }
            
            .notification-close:hover {
                color: var(--dark);
            }
            
            @keyframes slideIn {
                from {
                    transform: translateX(100%);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            
            @media (max-width: 768px) {
                .notification {
                    left: 20px;
                    right: 20px;
                    max-width: none;
                }
            }
        `;
        document.head.appendChild(styles);
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
    document.body.appendChild(notification);
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–∫—Ä—ã—Ç–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    notification.querySelector('.notification-close').addEventListener('click', function() {
        notification.style.animation = 'slideIn 0.3s ease reverse';
        setTimeout(() => {
            if (notification.parentNode) {
                notification.parentNode.removeChild(notification);
            }
        }, 300);
    });
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
    setTimeout(() => {
        if (notification.parentNode) {
            notification.style.animation = 'slideIn 0.3s ease reverse';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.parentNode.removeChild(notification);
                }
            }, 300);
        }
    }, 5000);
}

// –ü–æ–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram
async function showBookingSuccess() {
    const form = document.getElementById('bookingForm');
    const submitBtn = form.querySelector('.submit-btn');
    
    if (!submitBtn) return;
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç
    const originalHtml = submitBtn.innerHTML;
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏
    submitBtn.classList.add('loading');
    submitBtn.disabled = true;
    form.classList.add('form-loading');
    
    try {
        // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
        const formData = getFormData();
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ Telegram
        const isSent = await sendToTelegram(formData);
        
        if (isSent) {
            // –£—Å–ø–µ—à–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞
            submitBtn.classList.remove('loading');
            submitBtn.classList.add('success');
            submitBtn.querySelector('.btn-text').textContent = '‚úÖ –ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!';
            
            // –ß–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã –∑–∞–∫—Ä—ã–≤–∞–µ–º —Ñ–æ—Ä–º—É
            setTimeout(() => {
                closeBookingModal();
                form.reset();
                submitBtn.classList.remove('success', 'loading');
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalHtml;
                form.classList.remove('form-loading');
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
                showNotification('–°–ø–∞—Å–∏–±–æ! –ú—ã —Å–≤—è–∂–µ–º—Å—è —Å –≤–∞–º–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 30 –º–∏–Ω—É—Ç –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è.', 'success');
            }, 2000);
        } else {
            throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞—è–≤–∫—É');
        }
        
    } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏:', error);
        
        // –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏
        submitBtn.classList.remove('loading');
        submitBtn.classList.add('error');
        submitBtn.querySelector('.btn-text').textContent = '‚ùå –û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏';
        
        setTimeout(() => {
            submitBtn.classList.remove('error', 'loading');
            submitBtn.disabled = false;
            submitBtn.innerHTML = originalHtml;
            form.classList.remove('form-loading');
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Å–ø–ª—ã–≤–∞—é—â–µ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
            showNotification('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–∑–≤–æ–Ω–∏—Ç–µ –Ω–∞–º –Ω–∞–ø—Ä—è–º—É—é.', 'error');
        }, 2000);
    }
}

// –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
function setupBookingForm() {
    const form = document.getElementById('bookingForm');
    const checkinInput = document.getElementById('bookingCheckin');
    const checkoutInput = document.getElementById('bookingCheckout');
    
    if (!form) return;
    
    let isSubmitting = false; // –ó–∞—â–∏—Ç–∞ –æ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–∞—Ç—É –¥–ª—è –≤—ã–µ–∑–¥–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∑–∞–µ–∑–¥–∞
    if (checkinInput) {
        checkinInput.addEventListener('change', function() {
            if (this.value && checkoutInput) {
                checkoutInput.min = this.value;
                if (checkoutInput.value && checkoutInput.value <= this.value) {
                    checkoutInput.value = '';
                }
            }
        });
    }
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ñ–æ—Ä–º—ã
    form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        // –ó–∞—â–∏—Ç–∞ –æ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫
        if (isSubmitting) return;
        
        // –ë–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
        if (!validateBookingForm()) {
            return;
        }
        
        isSubmitting = true;
        showBookingSuccess().finally(() => {
            isSubmitting = false;
        });
    });
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
document.addEventListener('DOMContentLoaded', function() {
    setupImageErrorHandling();
    setupLazyLoading();
    enhanceMobileUX();
    setupPhoneMask();
    setupHeaderScroll();
    
    // –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é
    const menuToggle = document.getElementById('menuToggle');
    const navList = document.querySelector('.nav-list');
    
    if (menuToggle && navList) {
        menuToggle.addEventListener('click', function() {
            const isExpanded = navList.classList.toggle('active');
            menuToggle.textContent = isExpanded ? '‚úï' : '‚ò∞';
            menuToggle.setAttribute('aria-expanded', isExpanded);
            
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Ç–µ–ª–∞ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–æ–º –º–µ–Ω—é
            document.body.style.overflow = isExpanded ? 'hidden' : 'auto';
        });
        
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–µ–Ω—é –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —Å—Å—ã–ª–∫—É
        document.querySelectorAll('.nav-list a').forEach(link => {
            link.addEventListener('click', function() {
                navList.classList.remove('active');
                menuToggle.textContent = '‚ò∞';
                menuToggle.setAttribute('aria-expanded', 'false');
                document.body.style.overflow = 'auto';
            });
        });
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    const bookButtons = document.querySelectorAll('.book-btn, .cta-button');
    bookButtons.forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.preventDefault();
            openBookingModal();
        });
    });
    
    // –ö–Ω–æ–ø–∫–∞ "–ü–æ–¥—Ä–æ–±–Ω–µ–µ" –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö —Ç–æ–∂–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
    const detailButtons = document.querySelectorAll('.card-btn');
    detailButtons.forEach((btn, index) => {
        btn.addEventListener('click', function(e) {
            e.stopPropagation(); // –ß—Ç–æ–±—ã –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–ª–∞—Å—å –≥–∞–ª–µ—Ä–µ—è
            openBookingModal((index + 1).toString());
        });
    });
    
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º—ã –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
    setupBookingForm();
    
    // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω –ø–æ –∫–ª–∏–∫—É –Ω–∞ –æ–≤–µ—Ä–ª–µ–π
    document.querySelectorAll('.modal-overlay').forEach(overlay => {
        overlay.addEventListener('click', function() {
            closeApartmentModal();
            closeBookingModal();
        });
    });
});

// –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ ESC
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        closeApartmentModal();
        closeBookingModal();
    }
    if (e.key === 'ArrowRight') nextImage();
    if (e.key === 'ArrowLeft') prevImage();
});

console.log('DonSide apartments grid loaded with Telegram booking!');